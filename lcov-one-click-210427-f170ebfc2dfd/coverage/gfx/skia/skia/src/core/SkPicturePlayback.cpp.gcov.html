<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - mochitest-e10s.info - gfx/skia/skia/src/core/SkPicturePlayback.cpp</title>
  <link rel="stylesheet" type="text/css" href="../../../../../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../../../../../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../../../../../index.html">top level</a> - <a href="index.html">gfx/skia/skia/src/core</a> - SkPicturePlayback.cpp<span style="font-size: 80%;"> (source / <a href="SkPicturePlayback.cpp.func.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">mochitest-e10s.info</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">411</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2017-04-21</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">6</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Legend:</td>
            <td class="headerValueLeg">            Lines:
            <span class="coverLegendCov">hit</span>
            <span class="coverLegendNoCov">not hit</span>
</td>
            <td></td>
          </tr>
          <tr><td><img src="../../../../../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../../../../../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /*</a>
<span class="lineNum">       2 </span>            :  * Copyright 2014 Google Inc.
<span class="lineNum">       3 </span>            :  *
<span class="lineNum">       4 </span>            :  * Use of this source code is governed by a BSD-style license that can be
<span class="lineNum">       5 </span>            :  * found in the LICENSE file.
<span class="lineNum">       6 </span>            :  */
<span class="lineNum">       7 </span>            : 
<span class="lineNum">       8 </span>            : #include &quot;SkCanvas.h&quot;
<span class="lineNum">       9 </span>            : #include &quot;SkPatchUtils.h&quot;
<span class="lineNum">      10 </span>            : #include &quot;SkPictureData.h&quot;
<span class="lineNum">      11 </span>            : #include &quot;SkPicturePlayback.h&quot;
<span class="lineNum">      12 </span>            : #include &quot;SkPictureRecord.h&quot;
<span class="lineNum">      13 </span>            : #include &quot;SkReadBuffer.h&quot;
<span class="lineNum">      14 </span>            : #include &quot;SkRSXform.h&quot;
<span class="lineNum">      15 </span>            : #include &quot;SkTextBlob.h&quot;
<span class="lineNum">      16 </span>            : #include &quot;SkTDArray.h&quot;
<span class="lineNum">      17 </span>            : #include &quot;SkTypes.h&quot;
<span class="lineNum">      18 </span>            : 
<span class="lineNum">      19 </span>            : // matches old SkCanvas::SaveFlags
<span class="lineNum">      20 </span>            : enum LegacySaveFlags {
<span class="lineNum">      21 </span>            :     kHasAlphaLayer_LegacySaveFlags    = 0x04,
<span class="lineNum">      22 </span>            :     kClipToLayer_LegacySaveFlags      = 0x10,
<a name="23"><span class="lineNum">      23 </span>            : };</a>
<span class="lineNum">      24 </span>            : 
<span class="lineNum">      25 </span><span class="lineNoCov">          0 : SkCanvas::SaveLayerFlags SkCanvas::LegacySaveFlagsToSaveLayerFlags(uint32_t flags) {</span>
<span class="lineNum">      26 </span><span class="lineNoCov">          0 :     uint32_t layerFlags = 0;</span>
<span class="lineNum">      27 </span>            : 
<span class="lineNum">      28 </span><span class="lineNoCov">          0 :     if (0 == (flags &amp; kClipToLayer_LegacySaveFlags)) {</span>
<span class="lineNum">      29 </span><span class="lineNoCov">          0 :         layerFlags |= SkCanvas::kDontClipToLayer_PrivateSaveLayerFlag;</span>
<span class="lineNum">      30 </span>            :     }
<span class="lineNum">      31 </span><span class="lineNoCov">          0 :     if (0 == (flags &amp; kHasAlphaLayer_LegacySaveFlags)) {</span>
<span class="lineNum">      32 </span><span class="lineNoCov">          0 :         layerFlags |= kIsOpaque_SaveLayerFlag;</span>
<span class="lineNum">      33 </span>            :     }
<span class="lineNum">      34 </span><span class="lineNoCov">          0 :     return layerFlags;</span>
<span class="lineNum">      35 </span>            : }
<span class="lineNum">      36 </span>            : 
<span class="lineNum">      37 </span>            : /*
<span class="lineNum">      38 </span>            :  * Read the next op code and chunk size from 'reader'. The returned size
<span class="lineNum">      39 </span>            :  * is the entire size of the chunk (including the opcode). Thus, the
<span class="lineNum">      40 </span>            :  * offset just prior to calling ReadOpAndSize + 'size' is the offset
<span class="lineNum">      41 </span>            :  * to the next chunk's op code. This also means that the size of a chunk
<a name="42"><span class="lineNum">      42 </span>            :  * with no arguments (just an opcode) will be 4.</a>
<span class="lineNum">      43 </span>            :  */
<span class="lineNum">      44 </span><span class="lineNoCov">          0 : DrawType SkPicturePlayback::ReadOpAndSize(SkReadBuffer* reader, uint32_t* size) {</span>
<span class="lineNum">      45 </span><span class="lineNoCov">          0 :     uint32_t temp = reader-&gt;readInt();</span>
<span class="lineNum">      46 </span>            :     uint32_t op;
<span class="lineNum">      47 </span><span class="lineNoCov">          0 :     if (((uint8_t)temp) == temp) {</span>
<span class="lineNum">      48 </span>            :         // old skp file - no size information
<span class="lineNum">      49 </span><span class="lineNoCov">          0 :         op = temp;</span>
<span class="lineNum">      50 </span><span class="lineNoCov">          0 :         *size = 0;</span>
<span class="lineNum">      51 </span>            :     } else {
<span class="lineNum">      52 </span><span class="lineNoCov">          0 :         UNPACK_8_24(temp, op, *size);</span>
<span class="lineNum">      53 </span><span class="lineNoCov">          0 :         if (MASK_24 == *size) {</span>
<span class="lineNum">      54 </span><span class="lineNoCov">          0 :             *size = reader-&gt;readInt();</span>
<span class="lineNum">      55 </span>            :         }
<span class="lineNum">      56 </span>            :     }
<span class="lineNum">      57 </span><span class="lineNoCov">          0 :     return (DrawType)op;</span>
<span class="lineNum">      58 </span>            : }
<a name="59"><span class="lineNum">      59 </span>            : </a>
<span class="lineNum">      60 </span>            : 
<span class="lineNum">      61 </span><span class="lineNoCov">          0 : static const SkRect* get_rect_ptr(SkReadBuffer* reader, SkRect* storage) {</span>
<span class="lineNum">      62 </span><span class="lineNoCov">          0 :     if (reader-&gt;readBool()) {</span>
<span class="lineNum">      63 </span><span class="lineNoCov">          0 :         reader-&gt;readRect(storage);</span>
<span class="lineNum">      64 </span><span class="lineNoCov">          0 :         return storage;</span>
<span class="lineNum">      65 </span>            :     } else {
<span class="lineNum">      66 </span>            :         return nullptr;
<span class="lineNum">      67 </span>            :     }
<span class="lineNum">      68 </span>            : }
<span class="lineNum">      69 </span>            : 
<span class="lineNum">      70 </span>            : class TextContainer {
<span class="lineNum">      71 </span>            : public:
<span class="lineNum">      72 </span>            :     size_t length() { return fByteLength; }
<span class="lineNum">      73 </span>            :     const void* text() { return (const void*)fText; }
<span class="lineNum">      74 </span>            :     size_t fByteLength;
<span class="lineNum">      75 </span>            :     const char* fText;
<a name="76"><span class="lineNum">      76 </span>            : };</a>
<span class="lineNum">      77 </span>            : 
<span class="lineNum">      78 </span><span class="lineNoCov">          0 : void get_text(SkReadBuffer* reader, TextContainer* text) {</span>
<span class="lineNum">      79 </span><span class="lineNoCov">          0 :     size_t length = text-&gt;fByteLength = reader-&gt;readInt();</span>
<span class="lineNum">      80 </span><span class="lineNoCov">          0 :     text-&gt;fText = (const char*)reader-&gt;skip(length);</span>
<span class="lineNum">      81 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">      82 </span>            : 
<span class="lineNum">      83 </span><span class="lineNoCov">          0 : void SkPicturePlayback::draw(SkCanvas* canvas,</span>
<span class="lineNum">      84 </span>            :                              SkPicture::AbortCallback* callback,
<span class="lineNum">      85 </span>            :                              SkReadBuffer* buffer) {
<span class="lineNum">      86 </span>            :     AutoResetOpID aroi(this);
<span class="lineNum">      87 </span>            :     SkASSERT(0 == fCurOffset);
<span class="lineNum">      88 </span>            : 
<span class="lineNum">      89 </span>            :     SkAutoTDelete&lt;SkReadBuffer&gt; reader;
<span class="lineNum">      90 </span><span class="lineNoCov">          0 :     if (buffer) {</span>
<span class="lineNum">      91 </span><span class="lineNoCov">          0 :         reader.reset(buffer-&gt;clone(fPictureData-&gt;opData()-&gt;bytes(),</span>
<span class="lineNum">      92 </span><span class="lineNoCov">          0 :                                    fPictureData-&gt;opData()-&gt;size()));</span>
<span class="lineNum">      93 </span>            :     } else {
<span class="lineNum">      94 </span><span class="lineNoCov">          0 :         reader.reset(new SkReadBuffer(fPictureData-&gt;opData()-&gt;bytes(),</span>
<span class="lineNum">      95 </span><span class="lineNoCov">          0 :                                       fPictureData-&gt;opData()-&gt;size()));</span>
<span class="lineNum">      96 </span>            :     }
<span class="lineNum">      97 </span>            : 
<span class="lineNum">      98 </span>            :     // Record this, so we can concat w/ it if we encounter a setMatrix()
<span class="lineNum">      99 </span><span class="lineNoCov">          0 :     SkMatrix initialMatrix = canvas-&gt;getTotalMatrix();</span>
<span class="lineNum">     100 </span>            : 
<span class="lineNum">     101 </span><span class="lineNoCov">          0 :     SkAutoCanvasRestore acr(canvas, false);</span>
<span class="lineNum">     102 </span>            : 
<span class="lineNum">     103 </span><span class="lineNoCov">          0 :     while (!reader-&gt;eof()) {</span>
<span class="lineNum">     104 </span><span class="lineNoCov">          0 :         if (callback &amp;&amp; callback-&gt;abort()) {</span>
<span class="lineNum">     105 </span><span class="lineNoCov">          0 :             return;</span>
<span class="lineNum">     106 </span>            :         }
<span class="lineNum">     107 </span>            : 
<span class="lineNum">     108 </span><span class="lineNoCov">          0 :         fCurOffset = reader-&gt;offset();</span>
<span class="lineNum">     109 </span>            :         uint32_t size;
<span class="lineNum">     110 </span><span class="lineNoCov">          0 :         DrawType op = ReadOpAndSize(reader, &amp;size);</span>
<span class="lineNum">     111 </span><span class="lineNoCov">          0 :         if (!reader-&gt;validate(op &gt; UNUSED &amp;&amp; op &lt;= LAST_DRAWTYPE_ENUM)) {</span>
<span class="lineNum">     112 </span>            :             return;
<span class="lineNum">     113 </span>            :         }
<span class="lineNum">     114 </span>            : 
<span class="lineNum">     115 </span><span class="lineNoCov">          0 :         this-&gt;handleOp(reader, op, size, canvas, initialMatrix);</span>
<span class="lineNum">     116 </span>            :     }
<span class="lineNum">     117 </span>            : 
<span class="lineNum">     118 </span>            :     // need to propagate invalid state to the parent reader
<span class="lineNum">     119 </span><span class="lineNoCov">          0 :     if (buffer) {</span>
<span class="lineNum">     120 </span><span class="lineNoCov">          0 :         buffer-&gt;validate(reader-&gt;isValid());</span>
<span class="lineNum">     121 </span><span class="lineNoCov">          0 :     }</span>
<span class="lineNum">     122 </span>            : }
<span class="lineNum">     123 </span>            : 
<span class="lineNum">     124 </span><span class="lineNoCov">          0 : void SkPicturePlayback::handleOp(SkReadBuffer* reader,</span>
<span class="lineNum">     125 </span>            :                                  DrawType op,
<span class="lineNum">     126 </span>            :                                  uint32_t size,
<span class="lineNum">     127 </span>            :                                  SkCanvas* canvas,
<span class="lineNum">     128 </span>            :                                  const SkMatrix&amp; initialMatrix) {
<span class="lineNum">     129 </span><span class="lineNoCov">          0 :     switch (op) {</span>
<span class="lineNum">     130 </span>            :         case NOOP: {
<span class="lineNum">     131 </span>            :             SkASSERT(size &gt;= 4);
<span class="lineNum">     132 </span><span class="lineNoCov">          0 :             reader-&gt;skip(size - 4);</span>
<span class="lineNum">     133 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     134 </span>            :         case CLIP_PATH: {
<span class="lineNum">     135 </span><span class="lineNoCov">          0 :             const SkPath&amp; path = fPictureData-&gt;getPath(reader); </span>
<span class="lineNum">     136 </span><span class="lineNoCov">          0 :             uint32_t packed = reader-&gt;readInt(); </span>
<span class="lineNum">     137 </span>            :             SkCanvas::ClipOp clipOp = ClipParams_unpackRegionOp(packed);
<span class="lineNum">     138 </span><span class="lineNoCov">          0 :             bool doAA = ClipParams_unpackDoAA(packed);</span>
<span class="lineNum">     139 </span><span class="lineNoCov">          0 :             size_t offsetToRestore = reader-&gt;readInt();</span>
<span class="lineNum">     140 </span>            :             SkASSERT(!offsetToRestore || offsetToRestore &gt;= reader-&gt;offset());
<span class="lineNum">     141 </span><span class="lineNoCov">          0 :             canvas-&gt;clipPath(path, clipOp, doAA);</span>
<span class="lineNum">     142 </span><span class="lineNoCov">          0 :             if (canvas-&gt;isClipEmpty() &amp;&amp; offsetToRestore) {</span>
<span class="lineNum">     143 </span><span class="lineNoCov">          0 :                 reader-&gt;skip(offsetToRestore - reader-&gt;offset());</span>
<span class="lineNum">     144 </span>            :             }
<span class="lineNum">     145 </span>            :         } break;
<span class="lineNum">     146 </span>            :         case CLIP_REGION: {
<span class="lineNum">     147 </span><span class="lineNoCov">          0 :             SkRegion region;</span>
<span class="lineNum">     148 </span><span class="lineNoCov">          0 :             reader-&gt;readRegion(&amp;region);</span>
<span class="lineNum">     149 </span><span class="lineNoCov">          0 :             uint32_t packed = reader-&gt;readInt();</span>
<span class="lineNum">     150 </span><span class="lineNoCov">          0 :             SkCanvas::ClipOp clipOp = ClipParams_unpackRegionOp(packed);</span>
<span class="lineNum">     151 </span><span class="lineNoCov">          0 :             size_t offsetToRestore = reader-&gt;readInt();</span>
<span class="lineNum">     152 </span>            :             SkASSERT(!offsetToRestore || offsetToRestore &gt;= reader-&gt;offset());
<span class="lineNum">     153 </span><span class="lineNoCov">          0 :             canvas-&gt;clipRegion(region, clipOp);</span>
<span class="lineNum">     154 </span><span class="lineNoCov">          0 :             if (canvas-&gt;isClipEmpty() &amp;&amp; offsetToRestore) {</span>
<span class="lineNum">     155 </span><span class="lineNoCov">          0 :                 reader-&gt;skip(offsetToRestore - reader-&gt;offset());</span>
<span class="lineNum">     156 </span><span class="lineNoCov">          0 :             }</span>
<span class="lineNum">     157 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     158 </span>            :         case CLIP_RECT: {
<span class="lineNum">     159 </span>            :             SkRect rect;
<span class="lineNum">     160 </span><span class="lineNoCov">          0 :             reader-&gt;readRect(&amp;rect);</span>
<span class="lineNum">     161 </span><span class="lineNoCov">          0 :             uint32_t packed = reader-&gt;readInt();</span>
<span class="lineNum">     162 </span><span class="lineNoCov">          0 :             SkCanvas::ClipOp clipOp = ClipParams_unpackRegionOp(packed);</span>
<span class="lineNum">     163 </span><span class="lineNoCov">          0 :             bool doAA = ClipParams_unpackDoAA(packed);</span>
<span class="lineNum">     164 </span><span class="lineNoCov">          0 :             size_t offsetToRestore = reader-&gt;readInt();</span>
<span class="lineNum">     165 </span>            :             SkASSERT(!offsetToRestore || offsetToRestore &gt;= reader-&gt;offset());
<span class="lineNum">     166 </span><span class="lineNoCov">          0 :             canvas-&gt;clipRect(rect, clipOp, doAA);</span>
<span class="lineNum">     167 </span><span class="lineNoCov">          0 :             if (canvas-&gt;isClipEmpty() &amp;&amp; offsetToRestore) {</span>
<span class="lineNum">     168 </span><span class="lineNoCov">          0 :                 reader-&gt;skip(offsetToRestore - reader-&gt;offset());</span>
<span class="lineNum">     169 </span>            :             }
<span class="lineNum">     170 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     171 </span>            :         case CLIP_RRECT: {
<span class="lineNum">     172 </span>            :             SkRRect rrect;
<span class="lineNum">     173 </span><span class="lineNoCov">          0 :             reader-&gt;readRRect(&amp;rrect);</span>
<span class="lineNum">     174 </span><span class="lineNoCov">          0 :             uint32_t packed = reader-&gt;readInt();</span>
<span class="lineNum">     175 </span><span class="lineNoCov">          0 :             SkCanvas::ClipOp clipOp = ClipParams_unpackRegionOp(packed);</span>
<span class="lineNum">     176 </span><span class="lineNoCov">          0 :             bool doAA = ClipParams_unpackDoAA(packed);</span>
<span class="lineNum">     177 </span><span class="lineNoCov">          0 :             size_t offsetToRestore = reader-&gt;readInt();</span>
<span class="lineNum">     178 </span>            :             SkASSERT(!offsetToRestore || offsetToRestore &gt;= reader-&gt;offset());
<span class="lineNum">     179 </span><span class="lineNoCov">          0 :             canvas-&gt;clipRRect(rrect, clipOp, doAA);</span>
<span class="lineNum">     180 </span><span class="lineNoCov">          0 :             if (canvas-&gt;isClipEmpty() &amp;&amp; offsetToRestore) {</span>
<span class="lineNum">     181 </span><span class="lineNoCov">          0 :                 reader-&gt;skip(offsetToRestore - reader-&gt;offset());</span>
<span class="lineNum">     182 </span>            :             }
<span class="lineNum">     183 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     184 </span>            :         case PUSH_CULL: break;  // Deprecated, safe to ignore both push and pop.
<span class="lineNum">     185 </span>            :         case POP_CULL:  break;
<span class="lineNum">     186 </span>            :         case CONCAT: {
<span class="lineNum">     187 </span>            :             SkMatrix matrix;
<span class="lineNum">     188 </span><span class="lineNoCov">          0 :             reader-&gt;readMatrix(&amp;matrix);</span>
<span class="lineNum">     189 </span><span class="lineNoCov">          0 :             canvas-&gt;concat(matrix);</span>
<span class="lineNum">     190 </span>            :             break;
<span class="lineNum">     191 </span>            :         }
<span class="lineNum">     192 </span>            :         case DRAW_ANNOTATION: {
<span class="lineNum">     193 </span>            :             SkRect rect;
<span class="lineNum">     194 </span><span class="lineNoCov">          0 :             reader-&gt;readRect(&amp;rect);</span>
<span class="lineNum">     195 </span><span class="lineNoCov">          0 :             SkString key;</span>
<span class="lineNum">     196 </span><span class="lineNoCov">          0 :             reader-&gt;readString(&amp;key);</span>
<span class="lineNum">     197 </span><span class="lineNoCov">          0 :             canvas-&gt;drawAnnotation(rect, key.c_str(), reader-&gt;readByteArrayAsData().get());</span>
<span class="lineNum">     198 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     199 </span>            :         case DRAW_ARC: {
<span class="lineNum">     200 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     201 </span>            :             SkRect rect;
<span class="lineNum">     202 </span><span class="lineNoCov">          0 :             reader-&gt;readRect(&amp;rect);</span>
<span class="lineNum">     203 </span><span class="lineNoCov">          0 :             SkScalar startAngle = reader-&gt;readScalar();</span>
<span class="lineNum">     204 </span><span class="lineNoCov">          0 :             SkScalar sweepAngle = reader-&gt;readScalar();</span>
<span class="lineNum">     205 </span><span class="lineNoCov">          0 :             int useCenter = reader-&gt;readInt();</span>
<span class="lineNum">     206 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     207 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawArc(rect, startAngle, sweepAngle, SkToBool(useCenter), *paint);</span>
<span class="lineNum">     208 </span>            :             }
<span class="lineNum">     209 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     210 </span>            :         case DRAW_ATLAS: {
<span class="lineNum">     211 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     212 </span><span class="lineNoCov">          0 :             const SkImage* atlas = fPictureData-&gt;getImage(reader);</span>
<span class="lineNum">     213 </span><span class="lineNoCov">          0 :             const uint32_t flags = reader-&gt;readUInt();</span>
<span class="lineNum">     214 </span><span class="lineNoCov">          0 :             const int count = reader-&gt;readUInt();</span>
<span class="lineNum">     215 </span><span class="lineNoCov">          0 :             const SkRSXform* xform = (const SkRSXform*)reader-&gt;skip(count * sizeof(SkRSXform));</span>
<span class="lineNum">     216 </span><span class="lineNoCov">          0 :             const SkRect* tex = (const SkRect*)reader-&gt;skip(count * sizeof(SkRect));</span>
<span class="lineNum">     217 </span><span class="lineNoCov">          0 :             const SkColor* colors = nullptr;</span>
<span class="lineNum">     218 </span><span class="lineNoCov">          0 :             SkXfermode::Mode mode = SkXfermode::kDst_Mode;</span>
<span class="lineNum">     219 </span><span class="lineNoCov">          0 :             if (flags &amp; DRAW_ATLAS_HAS_COLORS) {</span>
<span class="lineNum">     220 </span><span class="lineNoCov">          0 :                 colors = (const SkColor*)reader-&gt;skip(count * sizeof(SkColor));</span>
<span class="lineNum">     221 </span><span class="lineNoCov">          0 :                 mode = (SkXfermode::Mode)reader-&gt;readUInt();</span>
<span class="lineNum">     222 </span>            :             }
<span class="lineNum">     223 </span><span class="lineNoCov">          0 :             const SkRect* cull = nullptr;</span>
<span class="lineNum">     224 </span><span class="lineNoCov">          0 :             if (flags &amp; DRAW_ATLAS_HAS_CULL) {</span>
<span class="lineNum">     225 </span><span class="lineNoCov">          0 :                 cull = (const SkRect*)reader-&gt;skip(sizeof(SkRect));</span>
<span class="lineNum">     226 </span>            :             }
<span class="lineNum">     227 </span><span class="lineNoCov">          0 :             canvas-&gt;drawAtlas(atlas, xform, tex, colors, count, mode, cull, paint);</span>
<span class="lineNum">     228 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     229 </span>            :         case DRAW_BITMAP: {
<span class="lineNum">     230 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     231 </span><span class="lineNoCov">          0 :             const SkImage* image = fPictureData-&gt;getBitmapAsImage(reader);</span>
<span class="lineNum">     232 </span>            :             SkPoint loc;
<span class="lineNum">     233 </span><span class="lineNoCov">          0 :             reader-&gt;readPoint(&amp;loc);</span>
<span class="lineNum">     234 </span><span class="lineNoCov">          0 :             canvas-&gt;drawImage(image, loc.fX, loc.fY, paint);</span>
<span class="lineNum">     235 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     236 </span>            :         case DRAW_BITMAP_RECT: {
<span class="lineNum">     237 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     238 </span><span class="lineNoCov">          0 :             const SkImage* image = fPictureData-&gt;getBitmapAsImage(reader);</span>
<span class="lineNum">     239 </span>            :             SkRect storage;
<span class="lineNum">     240 </span><span class="lineNoCov">          0 :             const SkRect* src = get_rect_ptr(reader, &amp;storage);   // may be null</span>
<span class="lineNum">     241 </span>            :             SkRect dst;
<span class="lineNum">     242 </span><span class="lineNoCov">          0 :             reader-&gt;readRect(&amp;dst);     // required</span>
<span class="lineNum">     243 </span><span class="lineNoCov">          0 :             SkCanvas::SrcRectConstraint constraint = (SkCanvas::SrcRectConstraint)reader-&gt;readInt();</span>
<span class="lineNum">     244 </span><span class="lineNoCov">          0 :             if (src) {</span>
<span class="lineNum">     245 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawImageRect(image, *src, dst, paint, constraint);</span>
<span class="lineNum">     246 </span>            :             } else {
<span class="lineNum">     247 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawImageRect(image, dst, paint, constraint);</span>
<span class="lineNum">     248 </span>            :             }
<span class="lineNum">     249 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     250 </span>            :         case DRAW_BITMAP_MATRIX: {
<span class="lineNum">     251 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     252 </span><span class="lineNoCov">          0 :             const SkImage* image = fPictureData-&gt;getBitmapAsImage(reader);</span>
<span class="lineNum">     253 </span>            :             SkMatrix matrix;
<span class="lineNum">     254 </span><span class="lineNoCov">          0 :             reader-&gt;readMatrix(&amp;matrix);</span>
<span class="lineNum">     255 </span>            : 
<span class="lineNum">     256 </span><span class="lineNoCov">          0 :             SkAutoCanvasRestore acr(canvas, true);</span>
<span class="lineNum">     257 </span><span class="lineNoCov">          0 :             canvas-&gt;concat(matrix);</span>
<span class="lineNum">     258 </span><span class="lineNoCov">          0 :             canvas-&gt;drawImage(image, 0, 0, paint);</span>
<span class="lineNum">     259 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     260 </span>            :         case DRAW_BITMAP_NINE: {
<span class="lineNum">     261 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     262 </span><span class="lineNoCov">          0 :             const SkImage* image = fPictureData-&gt;getBitmapAsImage(reader);</span>
<span class="lineNum">     263 </span>            :             SkIRect src;
<span class="lineNum">     264 </span><span class="lineNoCov">          0 :             reader-&gt;readIRect(&amp;src);</span>
<span class="lineNum">     265 </span>            :             SkRect dst;
<span class="lineNum">     266 </span><span class="lineNoCov">          0 :             reader-&gt;readRect(&amp;dst);</span>
<span class="lineNum">     267 </span><span class="lineNoCov">          0 :             canvas-&gt;drawImageNine(image, src, dst, paint);</span>
<span class="lineNum">     268 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     269 </span>            :         case DRAW_CLEAR:
<span class="lineNum">     270 </span><span class="lineNoCov">          0 :             canvas-&gt;clear(reader-&gt;readInt());</span>
<span class="lineNum">     271 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     272 </span>            :         case DRAW_DATA: {
<span class="lineNum">     273 </span>            :             // This opcode is now dead, just need to skip it for backwards compatibility
<span class="lineNum">     274 </span><span class="lineNoCov">          0 :             size_t length = reader-&gt;readInt();</span>
<span class="lineNum">     275 </span><span class="lineNoCov">          0 :             (void)reader-&gt;skip(length);</span>
<span class="lineNum">     276 </span>            :             // skip handles padding the read out to a multiple of 4
<span class="lineNum">     277 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     278 </span>            :         case DRAW_DRAWABLE:
<span class="lineNum">     279 </span><span class="lineNoCov">          0 :             canvas-&gt;drawDrawable(fPictureData-&gt;getDrawable(reader));</span>
<span class="lineNum">     280 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     281 </span>            :         case DRAW_DRAWABLE_MATRIX: {
<span class="lineNum">     282 </span>            :             SkMatrix matrix;
<span class="lineNum">     283 </span><span class="lineNoCov">          0 :             reader-&gt;readMatrix(&amp;matrix);</span>
<span class="lineNum">     284 </span><span class="lineNoCov">          0 :             SkDrawable* drawable = fPictureData-&gt;getDrawable(reader);</span>
<span class="lineNum">     285 </span><span class="lineNoCov">          0 :             canvas-&gt;drawDrawable(drawable, &amp;matrix);</span>
<span class="lineNum">     286 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     287 </span>            :         case DRAW_DRRECT: {
<span class="lineNum">     288 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     289 </span>            :             SkRRect outer, inner;
<span class="lineNum">     290 </span><span class="lineNoCov">          0 :             reader-&gt;readRRect(&amp;outer);</span>
<span class="lineNum">     291 </span><span class="lineNoCov">          0 :             reader-&gt;readRRect(&amp;inner);</span>
<span class="lineNum">     292 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     293 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawDRRect(outer, inner, *paint);</span>
<span class="lineNum">     294 </span>            :             }
<span class="lineNum">     295 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     296 </span>            :         case BEGIN_COMMENT_GROUP: {
<span class="lineNum">     297 </span><span class="lineNoCov">          0 :             SkString tmp;</span>
<span class="lineNum">     298 </span><span class="lineNoCov">          0 :             reader-&gt;readString(&amp;tmp);</span>
<span class="lineNum">     299 </span>            :             // deprecated (M44)
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     301 </span>            :         }
<span class="lineNum">     302 </span>            :         case COMMENT: {
<span class="lineNum">     303 </span><span class="lineNoCov">          0 :             SkString tmp;</span>
<span class="lineNum">     304 </span><span class="lineNoCov">          0 :             reader-&gt;readString(&amp;tmp);</span>
<span class="lineNum">     305 </span><span class="lineNoCov">          0 :             reader-&gt;readString(&amp;tmp);</span>
<span class="lineNum">     306 </span>            :             // deprecated (M44)
<span class="lineNum">     307 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     308 </span>            :         }
<span class="lineNum">     309 </span>            :         case END_COMMENT_GROUP:
<span class="lineNum">     310 </span>            :             // deprecated (M44)
<span class="lineNum">     311 </span>            :             break;
<span class="lineNum">     312 </span>            :         case DRAW_IMAGE: {
<span class="lineNum">     313 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     314 </span><span class="lineNoCov">          0 :             const SkImage* image = fPictureData-&gt;getImage(reader);</span>
<span class="lineNum">     315 </span>            :             SkPoint loc;
<span class="lineNum">     316 </span><span class="lineNoCov">          0 :             reader-&gt;readPoint(&amp;loc);</span>
<span class="lineNum">     317 </span><span class="lineNoCov">          0 :             canvas-&gt;drawImage(image, loc.fX, loc.fY, paint);</span>
<span class="lineNum">     318 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     319 </span>            :         case DRAW_IMAGE_LATTICE: {
<span class="lineNum">     320 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     321 </span><span class="lineNoCov">          0 :             const SkImage* image = fPictureData-&gt;getImage(reader);</span>
<span class="lineNum">     322 </span>            :             SkCanvas::Lattice lattice;
<span class="lineNum">     323 </span><span class="lineNoCov">          0 :             lattice.fXCount = reader-&gt;readInt();</span>
<span class="lineNum">     324 </span><span class="lineNoCov">          0 :             lattice.fXDivs = (const int*) reader-&gt;skip(lattice.fXCount * sizeof(int32_t));</span>
<span class="lineNum">     325 </span><span class="lineNoCov">          0 :             lattice.fYCount = reader-&gt;readInt();</span>
<span class="lineNum">     326 </span><span class="lineNoCov">          0 :             lattice.fYDivs = (const int*) reader-&gt;skip(lattice.fYCount * sizeof(int32_t));</span>
<span class="lineNum">     327 </span><span class="lineNoCov">          0 :             int flagCount = reader-&gt;readInt();</span>
<span class="lineNum">     328 </span>            :             lattice.fFlags = (0 == flagCount) ? nullptr : (const SkCanvas::Lattice::Flags*)
<span class="lineNum">     329 </span><span class="lineNoCov">          0 :                     reader-&gt;skip(SkAlign4(flagCount * sizeof(SkCanvas::Lattice::Flags)));</span>
<span class="lineNum">     330 </span>            :             SkIRect src;
<span class="lineNum">     331 </span><span class="lineNoCov">          0 :             reader-&gt;readIRect(&amp;src);</span>
<span class="lineNum">     332 </span><span class="lineNoCov">          0 :             lattice.fBounds = &amp;src;</span>
<span class="lineNum">     333 </span>            :             SkRect dst;
<span class="lineNum">     334 </span><span class="lineNoCov">          0 :             reader-&gt;readRect(&amp;dst);</span>
<span class="lineNum">     335 </span><span class="lineNoCov">          0 :             canvas-&gt;drawImageLattice(image, lattice, dst, paint);</span>
<span class="lineNum">     336 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     337 </span>            :         case DRAW_IMAGE_NINE: {
<span class="lineNum">     338 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     339 </span><span class="lineNoCov">          0 :             const SkImage* image = fPictureData-&gt;getImage(reader);</span>
<span class="lineNum">     340 </span>            :             SkIRect center;
<span class="lineNum">     341 </span><span class="lineNoCov">          0 :             reader-&gt;readIRect(&amp;center);</span>
<span class="lineNum">     342 </span>            :             SkRect dst;
<span class="lineNum">     343 </span><span class="lineNoCov">          0 :             reader-&gt;readRect(&amp;dst);</span>
<span class="lineNum">     344 </span><span class="lineNoCov">          0 :             canvas-&gt;drawImageNine(image, center, dst, paint);</span>
<span class="lineNum">     345 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     346 </span>            :         case DRAW_IMAGE_RECT_STRICT:
<span class="lineNum">     347 </span>            :         case DRAW_IMAGE_RECT: {
<span class="lineNum">     348 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     349 </span><span class="lineNoCov">          0 :             const SkImage* image = fPictureData-&gt;getImage(reader);</span>
<span class="lineNum">     350 </span>            :             SkRect storage;
<span class="lineNum">     351 </span><span class="lineNoCov">          0 :             const SkRect* src = get_rect_ptr(reader, &amp;storage);   // may be null</span>
<span class="lineNum">     352 </span>            :             SkRect dst;
<span class="lineNum">     353 </span><span class="lineNoCov">          0 :             reader-&gt;readRect(&amp;dst);     // required</span>
<span class="lineNum">     354 </span>            :             // DRAW_IMAGE_RECT_STRICT assumes this constraint, and doesn't store it
<span class="lineNum">     355 </span><span class="lineNoCov">          0 :             SkCanvas::SrcRectConstraint constraint = SkCanvas::kStrict_SrcRectConstraint;</span>
<span class="lineNum">     356 </span><span class="lineNoCov">          0 :             if (DRAW_IMAGE_RECT == op) {</span>
<span class="lineNum">     357 </span>            :                 // newer op-code stores the constraint explicitly
<span class="lineNum">     358 </span><span class="lineNoCov">          0 :                 constraint = (SkCanvas::SrcRectConstraint)reader-&gt;readInt();</span>
<span class="lineNum">     359 </span>            :             }
<span class="lineNum">     360 </span><span class="lineNoCov">          0 :             canvas-&gt;legacy_drawImageRect(image, src, dst, paint, constraint);</span>
<span class="lineNum">     361 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     362 </span>            :         case DRAW_OVAL: {
<span class="lineNum">     363 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     364 </span>            :             SkRect rect;
<span class="lineNum">     365 </span><span class="lineNoCov">          0 :             reader-&gt;readRect(&amp;rect);</span>
<span class="lineNum">     366 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     367 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawOval(rect, *paint);</span>
<span class="lineNum">     368 </span>            :             }
<span class="lineNum">     369 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     370 </span>            :         case DRAW_PAINT: {
<span class="lineNum">     371 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     372 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     373 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawPaint(*paint);</span>
<span class="lineNum">     374 </span>            :             }
<span class="lineNum">     375 </span>            :         } break;
<span class="lineNum">     376 </span>            :         case DRAW_PATCH: {
<span class="lineNum">     377 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     378 </span>            : 
<span class="lineNum">     379 </span>            :             const SkPoint* cubics = (const SkPoint*)reader-&gt;skip(SkPatchUtils::kNumCtrlPts *
<span class="lineNum">     380 </span><span class="lineNoCov">          0 :                                                                  sizeof(SkPoint));</span>
<span class="lineNum">     381 </span><span class="lineNoCov">          0 :             uint32_t flag = reader-&gt;readInt();</span>
<span class="lineNum">     382 </span><span class="lineNoCov">          0 :             const SkColor* colors = nullptr;</span>
<span class="lineNum">     383 </span><span class="lineNoCov">          0 :             if (flag &amp; DRAW_VERTICES_HAS_COLORS) {</span>
<span class="lineNum">     384 </span><span class="lineNoCov">          0 :                 colors = (const SkColor*)reader-&gt;skip(SkPatchUtils::kNumCorners * sizeof(SkColor));</span>
<span class="lineNum">     385 </span>            :             }
<span class="lineNum">     386 </span><span class="lineNoCov">          0 :             const SkPoint* texCoords = nullptr;</span>
<span class="lineNum">     387 </span><span class="lineNoCov">          0 :             if (flag &amp; DRAW_VERTICES_HAS_TEXS) {</span>
<span class="lineNum">     388 </span>            :                 texCoords = (const SkPoint*)reader-&gt;skip(SkPatchUtils::kNumCorners *
<span class="lineNum">     389 </span><span class="lineNoCov">          0 :                                                          sizeof(SkPoint));</span>
<span class="lineNum">     390 </span>            :             }
<span class="lineNum">     391 </span><span class="lineNoCov">          0 :             sk_sp&lt;SkXfermode&gt; xfer;</span>
<span class="lineNum">     392 </span><span class="lineNoCov">          0 :             if (flag &amp; DRAW_VERTICES_HAS_XFER) {</span>
<span class="lineNum">     393 </span><span class="lineNoCov">          0 :                 int mode = reader-&gt;readInt();</span>
<span class="lineNum">     394 </span><span class="lineNoCov">          0 :                 if (mode &lt; 0 || mode &gt; SkXfermode::kLastMode) {</span>
<span class="lineNum">     395 </span><span class="lineNoCov">          0 :                     mode = SkXfermode::kModulate_Mode;</span>
<span class="lineNum">     396 </span>            :                 }
<span class="lineNum">     397 </span><span class="lineNoCov">          0 :                 xfer = SkXfermode::Make((SkXfermode::Mode)mode);</span>
<span class="lineNum">     398 </span>            :             }
<span class="lineNum">     399 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     400 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawPatch(cubics, colors, texCoords, std::move(xfer), *paint);</span>
<span class="lineNum">     401 </span><span class="lineNoCov">          0 :             }</span>
<span class="lineNum">     402 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     403 </span>            :         case DRAW_PATH: {
<span class="lineNum">     404 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     405 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     406 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawPath(fPictureData-&gt;getPath(reader), *paint);</span>
<span class="lineNum">     407 </span>            :             }
<span class="lineNum">     408 </span>            :         } break;
<span class="lineNum">     409 </span>            :         case DRAW_PICTURE:
<span class="lineNum">     410 </span><span class="lineNoCov">          0 :             canvas-&gt;drawPicture(fPictureData-&gt;getPicture(reader));</span>
<span class="lineNum">     411 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     412 </span>            :         case DRAW_PICTURE_MATRIX_PAINT: {
<span class="lineNum">     413 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     414 </span>            :             SkMatrix matrix;
<span class="lineNum">     415 </span><span class="lineNoCov">          0 :             reader-&gt;readMatrix(&amp;matrix);</span>
<span class="lineNum">     416 </span><span class="lineNoCov">          0 :             const SkPicture* pic = fPictureData-&gt;getPicture(reader);</span>
<span class="lineNum">     417 </span><span class="lineNoCov">          0 :             canvas-&gt;drawPicture(pic, &amp;matrix, paint);</span>
<span class="lineNum">     418 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     419 </span>            :         case DRAW_POINTS: {
<span class="lineNum">     420 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     421 </span><span class="lineNoCov">          0 :             SkCanvas::PointMode mode = (SkCanvas::PointMode)reader-&gt;readInt();</span>
<span class="lineNum">     422 </span><span class="lineNoCov">          0 :             size_t count = reader-&gt;readInt();</span>
<span class="lineNum">     423 </span><span class="lineNoCov">          0 :             const SkPoint* pts = (const SkPoint*)reader-&gt;skip(sizeof(SkPoint)* count);</span>
<span class="lineNum">     424 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     425 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawPoints(mode, count, pts, *paint);</span>
<span class="lineNum">     426 </span>            :             }
<span class="lineNum">     427 </span>            :         } break;
<span class="lineNum">     428 </span>            :         case DRAW_POS_TEXT: {
<span class="lineNum">     429 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     430 </span>            :             TextContainer text;
<span class="lineNum">     431 </span><span class="lineNoCov">          0 :             get_text(reader, &amp;text);</span>
<span class="lineNum">     432 </span><span class="lineNoCov">          0 :             size_t points = reader-&gt;readInt();</span>
<span class="lineNum">     433 </span><span class="lineNoCov">          0 :             const SkPoint* pos = (const SkPoint*)reader-&gt;skip(points * sizeof(SkPoint));</span>
<span class="lineNum">     434 </span><span class="lineNoCov">          0 :             if (paint &amp;&amp; text.text()) {</span>
<span class="lineNum">     435 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawPosText(text.text(), text.length(), pos, *paint);</span>
<span class="lineNum">     436 </span>            :             }
<span class="lineNum">     437 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     438 </span>            :         case DRAW_POS_TEXT_TOP_BOTTOM: {
<span class="lineNum">     439 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     440 </span>            :             TextContainer text;
<span class="lineNum">     441 </span><span class="lineNoCov">          0 :             get_text(reader, &amp;text);</span>
<span class="lineNum">     442 </span><span class="lineNoCov">          0 :             size_t points = reader-&gt;readInt();</span>
<span class="lineNum">     443 </span><span class="lineNoCov">          0 :             const SkPoint* pos = (const SkPoint*)reader-&gt;skip(points * sizeof(SkPoint));</span>
<span class="lineNum">     444 </span><span class="lineNoCov">          0 :             const SkScalar top = reader-&gt;readScalar();</span>
<span class="lineNum">     445 </span><span class="lineNoCov">          0 :             const SkScalar bottom = reader-&gt;readScalar();</span>
<span class="lineNum">     446 </span>            :             SkRect clip;
<span class="lineNum">     447 </span><span class="lineNoCov">          0 :             canvas-&gt;getClipBounds(&amp;clip);</span>
<span class="lineNum">     448 </span><span class="lineNoCov">          0 :             if (top &lt; clip.fBottom &amp;&amp; bottom &gt; clip.fTop &amp;&amp; paint &amp;&amp; text.text()) {</span>
<span class="lineNum">     449 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawPosText(text.text(), text.length(), pos, *paint);</span>
<span class="lineNum">     450 </span>            :             }
<span class="lineNum">     451 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     452 </span>            :         case DRAW_POS_TEXT_H: {
<span class="lineNum">     453 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     454 </span>            :             TextContainer text;
<span class="lineNum">     455 </span><span class="lineNoCov">          0 :             get_text(reader, &amp;text);</span>
<span class="lineNum">     456 </span><span class="lineNoCov">          0 :             size_t xCount = reader-&gt;readInt();</span>
<span class="lineNum">     457 </span><span class="lineNoCov">          0 :             const SkScalar constY = reader-&gt;readScalar();</span>
<span class="lineNum">     458 </span><span class="lineNoCov">          0 :             const SkScalar* xpos = (const SkScalar*)reader-&gt;skip(xCount * sizeof(SkScalar));</span>
<span class="lineNum">     459 </span><span class="lineNoCov">          0 :             if (paint &amp;&amp; text.text()) {</span>
<span class="lineNum">     460 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawPosTextH(text.text(), text.length(), xpos, constY, *paint);</span>
<span class="lineNum">     461 </span>            :             }
<span class="lineNum">     462 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     463 </span>            :         case DRAW_POS_TEXT_H_TOP_BOTTOM: {
<span class="lineNum">     464 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     465 </span>            :             TextContainer text;
<span class="lineNum">     466 </span><span class="lineNoCov">          0 :             get_text(reader, &amp;text);</span>
<span class="lineNum">     467 </span><span class="lineNoCov">          0 :             size_t xCount = reader-&gt;readInt();</span>
<span class="lineNum">     468 </span><span class="lineNoCov">          0 :             const SkScalar* xpos = (const SkScalar*)reader-&gt;skip((3 + xCount) * sizeof(SkScalar));</span>
<span class="lineNum">     469 </span><span class="lineNoCov">          0 :             const SkScalar top = *xpos++;</span>
<span class="lineNum">     470 </span><span class="lineNoCov">          0 :             const SkScalar bottom = *xpos++;</span>
<span class="lineNum">     471 </span><span class="lineNoCov">          0 :             const SkScalar constY = *xpos++;</span>
<span class="lineNum">     472 </span>            :             SkRect clip;
<span class="lineNum">     473 </span><span class="lineNoCov">          0 :             canvas-&gt;getClipBounds(&amp;clip);</span>
<span class="lineNum">     474 </span><span class="lineNoCov">          0 :             if (top &lt; clip.fBottom &amp;&amp; bottom &gt; clip.fTop &amp;&amp; paint &amp;&amp; text.text()) {</span>
<span class="lineNum">     475 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawPosTextH(text.text(), text.length(), xpos, constY, *paint);</span>
<span class="lineNum">     476 </span>            :             }
<span class="lineNum">     477 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     478 </span>            :         case DRAW_RECT: {
<span class="lineNum">     479 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     480 </span>            :             SkRect rect;
<span class="lineNum">     481 </span><span class="lineNoCov">          0 :             reader-&gt;readRect(&amp;rect);</span>
<span class="lineNum">     482 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     483 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawRect(rect, *paint);</span>
<span class="lineNum">     484 </span>            :             }
<span class="lineNum">     485 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     486 </span>            :         case DRAW_REGION: {
<span class="lineNum">     487 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     488 </span><span class="lineNoCov">          0 :             SkRegion region;</span>
<span class="lineNum">     489 </span><span class="lineNoCov">          0 :             reader-&gt;readRegion(&amp;region);</span>
<span class="lineNum">     490 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     491 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawRegion(region, *paint);</span>
<span class="lineNum">     492 </span><span class="lineNoCov">          0 :             }</span>
<span class="lineNum">     493 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     494 </span>            :         case DRAW_RRECT: {
<span class="lineNum">     495 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     496 </span>            :             SkRRect rrect;
<span class="lineNum">     497 </span><span class="lineNoCov">          0 :             reader-&gt;readRRect(&amp;rrect);</span>
<span class="lineNum">     498 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     499 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawRRect(rrect, *paint);</span>
<span class="lineNum">     500 </span>            :             }
<span class="lineNum">     501 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     502 </span>            :         case DRAW_SPRITE: {
<span class="lineNum">     503 </span><span class="lineNoCov">          0 :             /* const SkPaint* paint = */ fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     504 </span><span class="lineNoCov">          0 :             /* const SkImage* image = */ fPictureData-&gt;getBitmapAsImage(reader);</span>
<span class="lineNum">     505 </span><span class="lineNoCov">          0 :             /* int left = */ reader-&gt;readInt();</span>
<span class="lineNum">     506 </span><span class="lineNoCov">          0 :             /* int top = */ reader-&gt;readInt();</span>
<span class="lineNum">     507 </span>            :             // drawSprite removed dec-2015
<span class="lineNum">     508 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     509 </span>            :         case DRAW_TEXT: {
<span class="lineNum">     510 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     511 </span>            :             TextContainer text;
<span class="lineNum">     512 </span><span class="lineNoCov">          0 :             get_text(reader, &amp;text);</span>
<span class="lineNum">     513 </span><span class="lineNoCov">          0 :             SkScalar x = reader-&gt;readScalar();</span>
<span class="lineNum">     514 </span><span class="lineNoCov">          0 :             SkScalar y = reader-&gt;readScalar();</span>
<span class="lineNum">     515 </span><span class="lineNoCov">          0 :             if (paint &amp;&amp; text.text()) {</span>
<span class="lineNum">     516 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawText(text.text(), text.length(), x, y, *paint);</span>
<span class="lineNum">     517 </span>            :             }
<span class="lineNum">     518 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     519 </span>            :         case DRAW_TEXT_BLOB: {
<span class="lineNum">     520 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     521 </span><span class="lineNoCov">          0 :             const SkTextBlob* blob = fPictureData-&gt;getTextBlob(reader);</span>
<span class="lineNum">     522 </span><span class="lineNoCov">          0 :             SkScalar x = reader-&gt;readScalar();</span>
<span class="lineNum">     523 </span><span class="lineNoCov">          0 :             SkScalar y = reader-&gt;readScalar();</span>
<span class="lineNum">     524 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     525 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawTextBlob(blob, x, y, *paint);</span>
<span class="lineNum">     526 </span>            :             }
<span class="lineNum">     527 </span>            :         } break;
<span class="lineNum">     528 </span>            :         case DRAW_TEXT_TOP_BOTTOM: {
<span class="lineNum">     529 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     530 </span>            :             TextContainer text;
<span class="lineNum">     531 </span><span class="lineNoCov">          0 :             get_text(reader, &amp;text);</span>
<span class="lineNum">     532 </span><span class="lineNoCov">          0 :             const SkScalar* ptr = (const SkScalar*)reader-&gt;skip(4 * sizeof(SkScalar));</span>
<span class="lineNum">     533 </span>            :             // ptr[0] == x
<span class="lineNum">     534 </span>            :             // ptr[1] == y
<span class="lineNum">     535 </span>            :             // ptr[2] == top
<span class="lineNum">     536 </span>            :             // ptr[3] == bottom
<span class="lineNum">     537 </span>            :             SkRect clip;
<span class="lineNum">     538 </span><span class="lineNoCov">          0 :             canvas-&gt;getClipBounds(&amp;clip);</span>
<span class="lineNum">     539 </span><span class="lineNoCov">          0 :             float top = ptr[2];</span>
<span class="lineNum">     540 </span><span class="lineNoCov">          0 :             float bottom = ptr[3];</span>
<span class="lineNum">     541 </span><span class="lineNoCov">          0 :             if (top &lt; clip.fBottom &amp;&amp; bottom &gt; clip.fTop &amp;&amp; paint &amp;&amp; text.text()) {</span>
<span class="lineNum">     542 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawText(text.text(), text.length(), ptr[0], ptr[1], *paint);</span>
<span class="lineNum">     543 </span>            :             }
<span class="lineNum">     544 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     545 </span>            :         case DRAW_TEXT_ON_PATH: {
<span class="lineNum">     546 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     547 </span>            :             TextContainer text;
<span class="lineNum">     548 </span><span class="lineNoCov">          0 :             get_text(reader, &amp;text);</span>
<span class="lineNum">     549 </span><span class="lineNoCov">          0 :             const SkPath&amp; path = fPictureData-&gt;getPath(reader);</span>
<span class="lineNum">     550 </span>            :             SkMatrix matrix;
<span class="lineNum">     551 </span><span class="lineNoCov">          0 :             reader-&gt;readMatrix(&amp;matrix);</span>
<span class="lineNum">     552 </span><span class="lineNoCov">          0 :             if (paint &amp;&amp; text.text()) {</span>
<span class="lineNum">     553 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawTextOnPath(text.text(), text.length(), path, &amp;matrix, *paint);</span>
<span class="lineNum">     554 </span>            :             }
<span class="lineNum">     555 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     556 </span>            :         case DRAW_TEXT_RSXFORM: {
<span class="lineNum">     557 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     558 </span><span class="lineNoCov">          0 :             int count = reader-&gt;readInt();</span>
<span class="lineNum">     559 </span><span class="lineNoCov">          0 :             uint32_t flags = reader-&gt;read32();</span>
<span class="lineNum">     560 </span>            :             TextContainer text;
<span class="lineNum">     561 </span><span class="lineNoCov">          0 :             get_text(reader, &amp;text);</span>
<span class="lineNum">     562 </span><span class="lineNoCov">          0 :             const SkRSXform* xform = (const SkRSXform*)reader-&gt;skip(count * sizeof(SkRSXform));</span>
<span class="lineNum">     563 </span><span class="lineNoCov">          0 :             const SkRect* cull = nullptr;</span>
<span class="lineNum">     564 </span><span class="lineNoCov">          0 :             if (flags &amp; DRAW_TEXT_RSXFORM_HAS_CULL) {</span>
<span class="lineNum">     565 </span><span class="lineNoCov">          0 :                 cull = (const SkRect*)reader-&gt;skip(sizeof(SkRect));</span>
<span class="lineNum">     566 </span>            :             }
<span class="lineNum">     567 </span><span class="lineNoCov">          0 :             if (text.text()) {</span>
<span class="lineNum">     568 </span><span class="lineNoCov">          0 :                 canvas-&gt;drawTextRSXform(text.text(), text.length(), xform, cull, *paint);</span>
<span class="lineNum">     569 </span>            :             }
<span class="lineNum">     570 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     571 </span>            :         case DRAW_VERTICES: {
<span class="lineNum">     572 </span><span class="lineNoCov">          0 :             sk_sp&lt;SkXfermode&gt; xfer;</span>
<span class="lineNum">     573 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     574 </span><span class="lineNoCov">          0 :             DrawVertexFlags flags = (DrawVertexFlags)reader-&gt;readInt();</span>
<span class="lineNum">     575 </span><span class="lineNoCov">          0 :             SkCanvas::VertexMode vmode = (SkCanvas::VertexMode)reader-&gt;readInt();</span>
<span class="lineNum">     576 </span><span class="lineNoCov">          0 :             int vCount = reader-&gt;readInt();</span>
<span class="lineNum">     577 </span><span class="lineNoCov">          0 :             const SkPoint* verts = (const SkPoint*)reader-&gt;skip(vCount * sizeof(SkPoint));</span>
<span class="lineNum">     578 </span><span class="lineNoCov">          0 :             const SkPoint* texs = nullptr;</span>
<span class="lineNum">     579 </span><span class="lineNoCov">          0 :             const SkColor* colors = nullptr;</span>
<span class="lineNum">     580 </span><span class="lineNoCov">          0 :             const uint16_t* indices = nullptr;</span>
<span class="lineNum">     581 </span><span class="lineNoCov">          0 :             int iCount = 0;</span>
<span class="lineNum">     582 </span><span class="lineNoCov">          0 :             if (flags &amp; DRAW_VERTICES_HAS_TEXS) {</span>
<span class="lineNum">     583 </span><span class="lineNoCov">          0 :                 texs = (const SkPoint*)reader-&gt;skip(vCount * sizeof(SkPoint));</span>
<span class="lineNum">     584 </span>            :             }
<span class="lineNum">     585 </span><span class="lineNoCov">          0 :             if (flags &amp; DRAW_VERTICES_HAS_COLORS) {</span>
<span class="lineNum">     586 </span><span class="lineNoCov">          0 :                 colors = (const SkColor*)reader-&gt;skip(vCount * sizeof(SkColor));</span>
<span class="lineNum">     587 </span>            :             }
<span class="lineNum">     588 </span><span class="lineNoCov">          0 :             if (flags &amp; DRAW_VERTICES_HAS_INDICES) {</span>
<span class="lineNum">     589 </span><span class="lineNoCov">          0 :                 iCount = reader-&gt;readInt();</span>
<span class="lineNum">     590 </span><span class="lineNoCov">          0 :                 indices = (const uint16_t*)reader-&gt;skip(iCount * sizeof(uint16_t));</span>
<span class="lineNum">     591 </span>            :             }
<span class="lineNum">     592 </span><span class="lineNoCov">          0 :             if (flags &amp; DRAW_VERTICES_HAS_XFER) {</span>
<span class="lineNum">     593 </span><span class="lineNoCov">          0 :                 int mode = reader-&gt;readInt();</span>
<span class="lineNum">     594 </span><span class="lineNoCov">          0 :                 if (mode &lt; 0 || mode &gt; SkXfermode::kLastMode) {</span>
<span class="lineNum">     595 </span><span class="lineNoCov">          0 :                     mode = SkXfermode::kModulate_Mode;</span>
<span class="lineNum">     596 </span>            :                 }
<span class="lineNum">     597 </span><span class="lineNoCov">          0 :                 xfer = SkXfermode::Make((SkXfermode::Mode)mode);</span>
<span class="lineNum">     598 </span>            :             }
<span class="lineNum">     599 </span><span class="lineNoCov">          0 :             if (paint) {</span>
<span class="lineNum">     600 </span>            :                 canvas-&gt;drawVertices(vmode, vCount, verts, texs, colors,
<span class="lineNum">     601 </span><span class="lineNoCov">          0 :                                      xfer, indices, iCount, *paint);</span>
<span class="lineNum">     602 </span><span class="lineNoCov">          0 :             }</span>
<span class="lineNum">     603 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     604 </span>            :         case RESTORE:
<span class="lineNum">     605 </span><span class="lineNoCov">          0 :             canvas-&gt;restore();</span>
<span class="lineNum">     606 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     607 </span>            :         case ROTATE:
<span class="lineNum">     608 </span><span class="lineNoCov">          0 :             canvas-&gt;rotate(reader-&gt;readScalar());</span>
<span class="lineNum">     609 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     610 </span>            :         case SAVE:
<span class="lineNum">     611 </span>            :             // SKPs with version &lt; 29 also store a SaveFlags param.
<span class="lineNum">     612 </span><span class="lineNoCov">          0 :             if (size &gt; 4) {</span>
<span class="lineNum">     613 </span><span class="lineNoCov">          0 :                 if (reader-&gt;validate(8 == size)) {</span>
<span class="lineNum">     614 </span><span class="lineNoCov">          0 :                     reader-&gt;readInt();</span>
<span class="lineNum">     615 </span>            :                 }
<span class="lineNum">     616 </span>            :             }
<span class="lineNum">     617 </span><span class="lineNoCov">          0 :             canvas-&gt;save();</span>
<span class="lineNum">     618 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     619 </span>            :         case SAVE_LAYER_SAVEFLAGS_DEPRECATED: {
<span class="lineNum">     620 </span>            :             SkRect storage;
<span class="lineNum">     621 </span><span class="lineNoCov">          0 :             const SkRect* boundsPtr = get_rect_ptr(reader, &amp;storage);</span>
<span class="lineNum">     622 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     623 </span><span class="lineNoCov">          0 :             auto flags = SkCanvas::LegacySaveFlagsToSaveLayerFlags(reader-&gt;readInt());</span>
<span class="lineNum">     624 </span><span class="lineNoCov">          0 :             canvas-&gt;saveLayer(SkCanvas::SaveLayerRec(boundsPtr, paint, flags));</span>
<span class="lineNum">     625 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     626 </span>            :         case SAVE_LAYER_SAVELAYERFLAGS_DEPRECATED_JAN_2016: {
<span class="lineNum">     627 </span>            :             SkRect storage;
<span class="lineNum">     628 </span><span class="lineNoCov">          0 :             const SkRect* boundsPtr = get_rect_ptr(reader, &amp;storage);</span>
<span class="lineNum">     629 </span><span class="lineNoCov">          0 :             const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     630 </span><span class="lineNoCov">          0 :             canvas-&gt;saveLayer(SkCanvas::SaveLayerRec(boundsPtr, paint, reader-&gt;readInt()));</span>
<span class="lineNum">     631 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     632 </span>            :         case SAVE_LAYER_SAVELAYERREC: {
<span class="lineNum">     633 </span>            :             SkCanvas::SaveLayerRec rec(nullptr, nullptr, nullptr, 0);
<span class="lineNum">     634 </span><span class="lineNoCov">          0 :             const uint32_t flatFlags = reader-&gt;readInt();</span>
<span class="lineNum">     635 </span>            :             SkRect bounds;
<span class="lineNum">     636 </span><span class="lineNoCov">          0 :             if (flatFlags &amp; SAVELAYERREC_HAS_BOUNDS) {</span>
<span class="lineNum">     637 </span><span class="lineNoCov">          0 :                 reader-&gt;readRect(&amp;bounds);</span>
<span class="lineNum">     638 </span><span class="lineNoCov">          0 :                 rec.fBounds = &amp;bounds;</span>
<span class="lineNum">     639 </span>            :             }
<span class="lineNum">     640 </span><span class="lineNoCov">          0 :             if (flatFlags &amp; SAVELAYERREC_HAS_PAINT) {</span>
<span class="lineNum">     641 </span><span class="lineNoCov">          0 :                 rec.fPaint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     642 </span>            :             }
<span class="lineNum">     643 </span><span class="lineNoCov">          0 :             if (flatFlags &amp; SAVELAYERREC_HAS_BACKDROP) {</span>
<span class="lineNum">     644 </span><span class="lineNoCov">          0 :                 const SkPaint* paint = fPictureData-&gt;getPaint(reader);</span>
<span class="lineNum">     645 </span><span class="lineNoCov">          0 :                 rec.fBackdrop = paint-&gt;getImageFilter();</span>
<span class="lineNum">     646 </span>            :             }
<span class="lineNum">     647 </span><span class="lineNoCov">          0 :             if (flatFlags &amp; SAVELAYERREC_HAS_FLAGS) {</span>
<span class="lineNum">     648 </span><span class="lineNoCov">          0 :                 rec.fSaveLayerFlags = reader-&gt;readInt();</span>
<span class="lineNum">     649 </span>            :             }
<span class="lineNum">     650 </span><span class="lineNoCov">          0 :             canvas-&gt;saveLayer(rec);</span>
<span class="lineNum">     651 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     652 </span>            :         case SCALE: {
<span class="lineNum">     653 </span><span class="lineNoCov">          0 :             SkScalar sx = reader-&gt;readScalar();</span>
<span class="lineNum">     654 </span><span class="lineNoCov">          0 :             SkScalar sy = reader-&gt;readScalar();</span>
<span class="lineNum">     655 </span><span class="lineNoCov">          0 :             canvas-&gt;scale(sx, sy);</span>
<span class="lineNum">     656 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     657 </span>            :         case SET_MATRIX: {
<span class="lineNum">     658 </span>            :             SkMatrix matrix;
<span class="lineNum">     659 </span><span class="lineNoCov">          0 :             reader-&gt;readMatrix(&amp;matrix);</span>
<span class="lineNum">     660 </span><span class="lineNoCov">          0 :             matrix.postConcat(initialMatrix);</span>
<span class="lineNum">     661 </span><span class="lineNoCov">          0 :             canvas-&gt;setMatrix(matrix);</span>
<span class="lineNum">     662 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     663 </span>            :         case SKEW: {
<span class="lineNum">     664 </span><span class="lineNoCov">          0 :             SkScalar sx = reader-&gt;readScalar();</span>
<span class="lineNum">     665 </span><span class="lineNoCov">          0 :             SkScalar sy = reader-&gt;readScalar();</span>
<span class="lineNum">     666 </span><span class="lineNoCov">          0 :             canvas-&gt;skew(sx, sy);</span>
<span class="lineNum">     667 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     668 </span>            :         case TRANSLATE: {
<span class="lineNum">     669 </span><span class="lineNoCov">          0 :             SkScalar dx = reader-&gt;readScalar();</span>
<span class="lineNum">     670 </span><span class="lineNoCov">          0 :             SkScalar dy = reader-&gt;readScalar();</span>
<span class="lineNum">     671 </span><span class="lineNoCov">          0 :             canvas-&gt;translate(dx, dy);</span>
<span class="lineNum">     672 </span><span class="lineNoCov">          0 :         } break;</span>
<span class="lineNum">     673 </span>            :         case TRANSLATE_Z: {
<span class="lineNum">     674 </span>            : #ifdef SK_EXPERIMENTAL_SHADOWING
<span class="lineNum">     675 </span>            :             SkScalar dz = reader-&gt;readScalar();
<span class="lineNum">     676 </span>            :             canvas-&gt;translateZ(dz);
<span class="lineNum">     677 </span>            : #endif
<span class="lineNum">     678 </span>            :         } break;
<span class="lineNum">     679 </span>            :         default:
<span class="lineNum">     680 </span>            :             SkASSERTF(false, &quot;Unknown draw type: %d&quot;, op);
<span class="lineNum">     681 </span>            :     }
<span class="lineNum">     682 </span><span class="lineNoCov">          0 : }</span>
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../../../../../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.10</a></td></tr>
  </table>
  <br>

</body>
</html>
